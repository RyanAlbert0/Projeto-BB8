<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acessar: BB8 Archaeologist</title>
    <script src="main.js"></script>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div id="title">
        <h1>BB8: Archaeologist</h1>
        <img src="../login/sesi-logo-14.png" id="logoSESI">
    </div>
    <div id="content">
        
        <div id="map">
            <!-- Mantive a imagem no DOM (oculta) — o canvas irá desenhá-la.
                 id agora é "table" conforme solicitado -->
            <img src="table.jpg" id="table" style="display:none">
        </div>
            <canvas id="canvas" width="400" height="300"></canvas>
            <img src="imagembb8.png" id="bb8Image" alt="Imagem do BB8">
        <script>
document.addEventListener('DOMContentLoaded', () => {
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // elemento da imagem (id "table") que será desenhada no canvas
    const tableImg = document.getElementById('table');

    // Pontos fixos (coordenadas relativas à imagem/canvas)
    const points = [
        // { x: 126, y: 107 },
        // { x: 60, y: 400 },
        // { x: 630, y: 80 },
        // { x: 650, y: 500 },
        // { x: 820, y: 975 },
        // { x: 1150, y: 970 },
        // { x: 1185, y: 520 },
        // { x: 1320, y: 475 },
        // { x: 1280, y: 50 },
        // { x: 1530, y: 60 },
        // { x: 1780, y: 140 },
        // { x: 1830, y: 450 },

    ];

    // Gera checkboxes para cada ponto
    const controlsDiv = document.getElementById('controls');

    // guarda a ordem em que os pontos foram selecionados
    const selectionOrder = [];

    points.forEach((_, i) => {
        const label = document.createElement('label');
        label.style.marginRight = "10px";
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'point';
        checkbox.value = i;

        // atualiza a ordem ao marcar/desmarcar
        checkbox.addEventListener('change', () => {
            const idx = Number(checkbox.value);
            if (checkbox.checked) {
                const exist = selectionOrder.indexOf(idx);
                if (exist !== -1) selectionOrder.splice(exist, 1);
                selectionOrder.push(idx);
            } else {
                const pos = selectionOrder.indexOf(idx);
                if (pos !== -1) selectionOrder.splice(pos, 1);
            }
            draw();
        });

        label.appendChild(checkbox);
        label.appendChild(document.createTextNode(` Ponto ${i+1} `));
        controlsDiv.appendChild(label);
    });

    // Ajusta canvas para o tamanho da imagem e desenha
    function prepareCanvasAndDraw() {
        // usa dimensões naturais da imagem para o canvas
        canvas.width = tableImg.naturalWidth || tableImg.width || canvas.width;
        canvas.height = tableImg.naturalHeight || tableImg.height || canvas.height;
        draw();
    }

    function draw() {
        // desenha a imagem de fundo
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        if (tableImg.complete && tableImg.naturalWidth) {
            ctx.drawImage(tableImg, 0, 0, canvas.width, canvas.height);
        } else {
            // se imagem não estiver pronta, fundo branco
            ctx.fillStyle = "#fff";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // Desenha pontos
        points.forEach((point, i) => {
            const color = point.color || '#FF3366';
            ctx.beginPath();
            ctx.arc(point.x, point.y, 7, 0, 2 * Math.PI);
            ctx.fillStyle = color;
            ctx.fill();

            ctx.font = "bold 14px Arial";
            ctx.fillStyle = "#222";
            ctx.fillText(`P${i+1}`, point.x + 10, point.y - 10);
        });

        // Desenha linha na ordem de seleção
        if (selectionOrder.length >= 2) {
            ctx.beginPath();
            ctx.moveTo(points[selectionOrder[0]].x, points[selectionOrder[0]].y);
            for (let i = 1; i < selectionOrder.length; i++) {
                const p = points[selectionOrder[i]];
                ctx.lineTo(p.x, p.y);
            }
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
        }
    }

    // Se a imagem já estiver carregada, prepara canvas; senão espera o load
    if (tableImg.complete && tableImg.naturalWidth) {
        prepareCanvasAndDraw();
    } else {
        tableImg.addEventListener('load', prepareCanvasAndDraw);
    }
});
    </script>
        <div id="inputs">
            <input type="text" id="slot" placeholder="Insira o nome da missão">
            <input type="number" id="time" placeholder="Insira o tempo">
            <input type="number" id="hurdle" placeholder="Insira a complexidade">
            <div class="controls" id="controls"></div>
            <button type="button" id="addButton">Adicionar a lista</button>
            <a href="../exibirSaidas/exibirSaidas.html"> Exibir Saídas</a> 
        </div>
    </div>

    <style>
                /* Fontes */
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz@8..144&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@500&display=swap');
        body {

            font-family: 'Roboto Serif', serif;
            color: rgb(0, 0, 0);
            padding: 0px;
            margin: 0px;
            box-sizing: border-box;
            background-color: rgb(242, 195, 151);
        }

        #logoSESI {
            height: 50%;
            margin: 10px;
        }

        #title {
            background-color: rgb(255, 123, 0);
            height: 80px;           /* Altura fixa para o header */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 25px;
            font-family: 'Share Tech', sans-serif;
        }

        #content {
            display: flex;
            flex-direction: row;
            /* Alinha ao topo para que canvas e inputs fiquem alinhados na mesma linha */
            align-items: flex-start;
            justify-content: center;
            width: 100vw;
            height: calc(100vh - 80px); /* Altura total da viewport menos a altura do título */

            /* Mantém position:relative caso queira posicionar filhos relativamente ao container */
            position: relative;
        }

        #inputs {
            display: flex;
            flex-direction: column;
            align-items: center; /* centraliza os inputs horizontalmente */
            justify-content: flex-start;
            width: 40%;
            height: auto;
            padding: 20px; /* mais espaço interno */
            margin-top: 12%;

        }

        /* Estiliza todos os inputs e select dentro de #inputs */
        #inputs input[type="number"]{   
            width: 80%;
            height: 40px;
            margin: 8px 0;
            padding: 8px 12px;
            border: 2px solid transparent;
            border-radius: 4px;
            background-color: white;
            font-size: 16px;
            transition: all 0.2s ease;

        }

        /* Estilo quando o input está em foco */
        #inputs input[type="number"]:focus,
        #inputs select:focus {
            border-color: black; /* borda preta quando selecionado */
            outline: none; /* remove outline padrão do navegador */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* sombra sutil */
        }

        /* Estilo especial para o checkbox */
        #inputs input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin: 10px 0;
            cursor: pointer;
        }

        /* Estilo para o botão */
        #inputs button,a {
            width: 30%;
            height: 40px;
            margin: 10px 0;
            background-color: rgb(255, 123, 0);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-family:sans-serif; 
        }

        #inputs button:hover {
            background-color: rgb(225, 108, 0);
        }

        /* Estilo para o link como botão */
        #inputs a {
            color: rgb(255, 255, 255);
            text-decoration: none;
            margin: 10px 0;
            font-size: 16px;
            width: 30%;
            height: 40px;
            background-color: rgb(255, 123, 0);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
            font-family: sans-serif; 

        }


        #canvas {
            width: 50%;
            height: auto;
            margin: auto;

            /* Volta para o fluxo normal (não absoluto) para ficar lado a lado com #inputs */
            position: relative;
            align-self: flex-start; /* sobe para o topo do container */

            /* Espaçamento entre canvas e os inputs — ajuste conforme preferir */
            margin-right: 20px;
        }

        #buttons{
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: auto;
            margin-top: 20px;

        }
        #inputs select {
            width: 80%;
            height: 40px;
            margin: 8px 0;
            padding: 8px 12px;
            border: 2px solid transparent;
            border-radius: 4px;
            background-color: white;
            font-size: 16px;
            transition: all 0.2s ease;
        }
        #slot
        {
            width: 80%;
            height: 40px;
            margin: 8px 0;
            padding: 8px 12px;
            border: 2px solid transparent;
            border-radius: 4px;
            background-color: white;
            font-size: 16px;
            transition: all 0.2s ease;
        }
        #bb8Image {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 20%; /* Ajuste o tamanho conforme necessário */
            height: auto;
            z-index: 10; /* Garante que a imagem fique acima de outros elementos */
        }

        #inputs input[type="number"]::-webkit-inner-spin-button{

            -webkit-appearance: none;
        }

        #inputs input[type="number"]::-webkit-outer-spin-button{

            -webkit-appearance: none;
        }
    </style>
</body>
</html>